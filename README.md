# –ö–æ–º–ø–æ–Ω–µ–Ω—Ç "–ò–∑–±—Ä–∞–Ω–Ω–æ–µ" –¥–ª—è –ë–∏—Ç—Ä–∏–∫—Å

–≠—Ç–æ—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –ø–æ–∑–≤–æ–ª—è–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –¥–æ–±–∞–≤–ª—è—Ç—å —Ä–∞–∑–ª–∏—á–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏ (—ç–ª–µ–º–µ–Ω—Ç—ã –∏–Ω—Ñ–æ–±–ª–æ–∫–æ–≤, —Ä–∞–∑–¥–µ–ª—ã, –∞—É–¥–∏–æ/–≤–∏–¥–µ–æ —Ñ–∞–π–ª—ã) –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ.

## üìå –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏ —É–¥–∞–ª–µ–Ω–∏–µ –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ —Å –ø–æ–º–æ—â—å—é –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞.
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö —Ç–∏–ø–æ–≤ —Å—É—â–Ω–æ—Å—Ç–µ–π (—ç–ª–µ–º–µ–Ω—Ç—ã –ò–ë, —Ä–∞–∑–¥–µ–ª—ã –ò–ë, —Ñ–∞–π–ª—ã).
- –í–∞—Ä–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è (—Ç–µ–∫—Å—Ç, –∏–∫–æ–Ω–∫–∏, –∫–∞—Å—Ç–æ–º–Ω—ã–π SVG).
- –ì–∏–±–∫–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ü–≤–µ—Ç–∞ –∑–∞–ª–∏–≤–∫–∏ –∏–∫–æ–Ω–æ–∫.
- –£–¥–æ–±–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º —Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ Highload-–±–ª–æ–∫–µ.

## üîß –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### 1Ô∏è‚É£ –°–æ–∑–¥–∞–Ω–∏–µ Highload-–±–ª–æ–∫–∞ –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ
–°–æ–∑–¥–∞–π—Ç–µ Highload-–±–ª–æ–∫ –≤ –ë–∏—Ç—Ä–∏–∫—Å–µ –≤—Ä—É—á–Ω—É—é –∏–ª–∏ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ SQL-–∑–∞–ø—Ä–æ—Å:

#### SQL-—Ñ–∞–π–ª –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã (–µ—Å–ª–∏ –≤—Ä—É—á–Ω—É—é)
```mysql
CREATE TABLE `b_hlbd_favorites` (
    `ID` INT(11) NOT NULL AUTO_INCREMENT,
    `UF_USER_ID` INT(11) NOT NULL,
    `UF_ENTITY` VARCHAR(50) NOT NULL,
    `UF_ENTITY_ID` INT(11) NOT NULL,
    `UF_DATE_ADD` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    PRIMARY KEY (`ID`),
    UNIQUE KEY `user_entity_unique` (`UF_USER_ID`, `UF_ENTITY`, `UF_ENTITY_ID`)

) ENGINE=InnoDB DEFAULT CHARSET=utf8;
```

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Highload-–±–ª–æ–∫–∞
| –ü–æ–ª–µ          | –¢–∏–ø –¥–∞–Ω–Ω—ã—Ö | –û–ø–∏—Å–∞–Ω–∏–µ                         |
|--------------|-----------|--------------------------------|
| `UF_USER_ID`   | `int`       | ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è               |
| `UF_ENTITY`    | `string`    | –¢–∏–ø —Å—É—â–Ω–æ—Å—Ç–∏ (`IBLOCK`, `FILE`, `SECTION`) |
| `UF_ENTITY_ID` | `int`       | ID —Å—É—â–Ω–æ—Å—Ç–∏                   |
| `UF_DATE_ADD`  | `datetime`  | –î–∞—Ç–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ   |

## 2Ô∏è‚É£ –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ–∞–π–ª–æ–≤ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é:

/local/components/custom/favorites/

## 3Ô∏è‚É£ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞

–î–æ–±–∞–≤—å—Ç–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –≤ –Ω—É–∂–Ω–æ–µ –º–µ—Å—Ç–æ, –Ω–∞–ø—Ä–∏–º–µ—Ä, –≤ template.php:
```php
<?$APPLICATION->IncludeComponent("custom:favorites", "", [
    "ENTITY" => "IBLOCK",
    "ENTITY_ID" => $arResult["ID"],
    "ADD_TEXT" => "–î–æ–±–∞–≤–∏—Ç—å –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ",
    "REMOVE_TEXT" => "–£–¥–∞–ª–∏—Ç—å –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ",
    "USE_ICONS" => "Y",
    "ICON_TYPE" => "HEART",
    "ICON_COLOR" => "#cccccc",
    "ICON_ACTIVE_COLOR" => "#ff0000",
]);?>
```

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
| –ü–∞—Ä–∞–º–µ—Ç—Ä            | –¢–∏–ø     | –û–ø–∏—Å–∞–Ω–∏–µ                                    | –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é |
|---------------------|---------|---------------------------------------------|------------------------|
| `ENTITY`            | `string`  | –¢–∏–ø —Å—É—â–Ω–æ—Å—Ç–∏ (`IBLOCK`, `SECTION`, `FILE`) | `"IBLOCK"`            |
| `ENTITY_ID`         | `int`     | ID —Å—É—â–Ω–æ—Å—Ç–∏                                | `0`                    |
| `ADD_TEXT`         | `string`  | –¢–µ–∫—Å—Ç "–î–æ–±–∞–≤–∏—Ç—å –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ"               | `"–î–æ–±–∞–≤–∏—Ç—å"`           |
| `REMOVE_TEXT`      | `string`  | –¢–µ–∫—Å—Ç "–£–¥–∞–ª–∏—Ç—å –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ"              | `"–£–¥–∞–ª–∏—Ç—å"`            |
| `USE_ICONS`        | `string`  | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏–∫–æ–Ω–∫–∏ (`Y`/`N`)               | `"Y"`                  |
| `ICON_TYPE`        | `string`  | –¢–∏–ø –∏–∫–æ–Ω–∫–∏ (`HEART`, `STAR`, `CUSTOM`)      | `"HEART"`              |
| `CUSTOM_SVG`       | `string`  | –°–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π SVG-–∫–æ–¥                        | `""`                   |
| `ICON_COLOR`       | `string`  | –¶–≤–µ—Ç SVG-–∏–∫–æ–Ω–∫–∏ (–æ–±—ã—á–Ω—ã–π)                   | `"#cccccc"`            |
| `ICON_ACTIVE_COLOR` | `string`  | –¶–≤–µ—Ç SVG-–∏–∫–æ–Ω–∫–∏ (–∞–∫—Ç–∏–≤–Ω—ã–π)                  | `"#ff0000"`            |


## üìå –î–æ–ø–æ–ª–Ω–µ–Ω–∏–µ: –†–∞–±–æ—Ç–∞ —Å –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–æ–º –≤ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç–µ

–ö–æ–º–ø–æ–Ω–µ–Ω—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º Bitrix\Controllerable –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –∏–∑–±—Ä–∞–Ω–Ω—ã–º —á–µ—Ä–µ–∑ AJAX-–∑–∞–ø—Ä–æ—Å—ã.
‚öôÔ∏è –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä?

–ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä —Ä–µ–∞–ª–∏–∑—É–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞, —á—Ç–æ –∏—Å–∫–ª—é—á–∞–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç—å –≤ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö AJAX-–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞—Ö.

### 1Ô∏è‚É£ –ú–µ—Ç–æ–¥ toggleFavoriteAction()

–≠—Ç–æ—Ç –º–µ—Ç–æ–¥ –¥–æ–±–∞–≤–ª—è–µ—Ç –∏–ª–∏ —É–¥–∞–ª—è–µ—Ç —ç–ª–µ–º–µ–Ω—Ç –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ.

```js
BX.ajax.runComponentAction('custom:favorites', 'toggleFavorite', {
    mode: 'class',
    data: { 
        entity: this.dataset.entity, 
        entityId: this.dataset.id, 
        action: this.dataset.favorite === "true" ? "remove" : "add" 
    }
})
```

## üìú –õ–∏—Ü–µ–Ω–∑–∏—è

MIT

## üìú –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫

    –ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏ / –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫: Alfa (Alexander Fast)
    –ö–æ–Ω—Ç–∞–∫—Ç: [lyxx@mail.ru / alfalyxx.pro]
    –í–µ—Ä—Å–∏—è –º–æ–¥—É–ª—è: 1.0.0